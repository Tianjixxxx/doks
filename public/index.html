<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>API Dashboard</title>
<style>
body{font-family:system-ui;background:#0f172a;color:#e5e7eb;padding:30px}
h1{text-align:center}
.category{background:#111827;border-radius:14px;padding:16px;margin-bottom:16px}
.cat-header{display:flex;justify-content:space-between;cursor:pointer}
.cat-name{font-size:1.2rem;font-weight:800}
.api{margin-top:10px;padding:10px;background:#1f2933;border-radius:10px}
.endpoint{font-family:monospace;color:#93c5fd}
button{margin-top:6px;padding:6px 10px;border:none;border-radius:8px;cursor:pointer}
</style>
</head>
<body>

<h1>ðŸ“š API Dashboard</h1>
<div id="app">Loading...</div>

<script>
async function load() {
  const r = await fetch("/api");
  const data = await r.json();
  const app = document.getElementById("app");
  app.innerHTML = "";

  data.categories.forEach(cat => {
    const div = document.createElement("div");
    div.className = "category";

    div.innerHTML = `
      <div class="cat-header">
        <div class="cat-name">${cat.name}</div>
        <div>${cat.count} APIs</div>
      </div>
      <div class="apis" style="display:none"></div>
    `;

    const apisDiv = div.querySelector(".apis");

    cat.apis.forEach(api => {
      const el = document.createElement("div");
      el.className = "api";
      el.innerHTML = `
        <div><b>${api.name}</b></div>
        <div>${api.description}</div>
        <div class="endpoint">${api.endpoint}</div>
        <button onclick="copy('${location.origin}${api.endpoint}')">Copy URL</button>
      `;
      apisDiv.appendChild(el);
    });

    div.querySelector(".cat-header").onclick = () => {
      apisDiv.style.display = apisDiv.style.display === "none" ? "block" : "none";
    };

    app.appendChild(div);
  });
}

function copy(text) {
  navigator.clipboard.writeText(text);
  alert("URL copied!");
}

load();
</script>

</body>
</html>